{% extends "layouts/kineLayout.html" %}

{% block title %}Seleccion Ejercicio{% endblock %}

{% block body %}
<div class="fondo container"> 
    <div class="row">
        <nav class="m-1" style="--bs-breadcrumb-divider: '>';">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('kinesiologo_main') }}"><i class="fa-solid fa-home"></i></a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('listar_pacientes', id_kinesiologo=current_user.get_id()) }}">Pacientes</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('crear_rutina', id_paciente = id_paciente) }}">Rutinas</a></li>
                <li class="breadcrumb-item active">Seleccionar Ejercicio</li>
            </ol>
        </nav>
    </div>
<!-- F O R M U L A R I O - S E L E C C I O N A R - E J E R C I C I O S -->

<button type="button" class="btn btn-success m-1" data-bs-toggle="modal" data-bs-target="#exampleModal">
    <i class="fa-solid fa-plus">
    </i>
    A침adir ejercicio
</button>

<div class="row">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div class="align-items-center justify-content-center">
            {% for category,message in messages %}
                <div class="alert col-lg-12  alert-{{category}} alert-dismissible show fade" role="alert" id="alert-message">
                    <strong>{{message}}</strong> 
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>                        
                </div>    
            {% endfor %}
        </div>
    {% endif %}
    {% endwith %}
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel2">A침adir ejercicio</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="container col-md-12 card" style="background-color:#c5d7f2">
                <h3 style="border-radius: 15px; background-color: #3452b3; color: #d8d8ce;" class="p-2 mt-2 display-6 fw-bold card-title bg-gradient">Elija el ejercicio:</h3>
                <form class="card-body" method="post">
                    <div class="form-floating mb-3">
                        <select class="form-select form-select-md" name="ejercicio" id="ejercicio">
                            <option>Seleccione una opci칩n</option>                                                                                    
                            {% for i in ejercicios %}
                            <option value="{{i.id}}">{{i.nombre}}</option>
                            {% endfor %}
                        </select>
                        <label for="ejercicio" class="form-label">Ejercicio realizado</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input
                            type="number"
                            class="form-control"
                            name="peso"
                            id="peso"
                            placeholder=""
                        />
                        <label for="peso">Peso</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input
                            type="number"
                            class="form-control"
                            name="repeticiones"
                            id="repeticiones"
                            placeholder=""
                        />
                        <label for="repeticiones">Repeticiones</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input
                            type="number"
                            class="form-control"
                            name="series"
                            id="series"
                            placeholder=""
                        />
                        <label for="series">Series</label>
                    </div>                  
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                                                                                                                                    
                    <br>
                    <div class="">
                        <button class="btn btn-primary m-1 col-md-2" type="submit" name="submit" value="crear"><i class="fa-solid fa-calendar-plus"></i> Crear</button>
                    </div>
                    <div class="">
                        <button class="btn btn-danger m-1 col-md-2" type="button" id="borrarCampos"><i class="fa-solid fa-eraser"></i> Limpiar</button>
                    </div>
                </form>
            </div>
        </div>
        <div class="modal-footer">
        <button type="button" class="btn btn-warning" data-bs-dismiss="modal"><i class="fa-solid fa-x"></i> Cerrar</button>
        </div>
    </div>
    </div>
</div>

<div class="container col-md-8">
    <div class="table-responsive rounded">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th class="col-md-1" scope="col">Ejercicio:</th>
                    <th class="col-md-1" scope="col">Nombre Ejercicio:</th>
                    <th class="col-md-2" scope="col">Serie:</th>
                    <th class="col-md-2" scope="col">Repeticiones:</th>
                    <th class="col-md-2" scope="col">Peso:</th>
                    <th class="col-md-3" scope="col">Acciones:</th>
                </tr>
            </thead>
            <tbody>
                {% for i in rutina %}
                    <tr class="scope table-primary">
                        <td>{{loop.index}}</td>
                        <td>
                            {% for j in ejercicios %}
                                {% if j.id == i.fk_id_ejercicio %}
                                    {{j.nombre}}
                                {% endif %}                                        
                            {% endfor %}                                    
                        </td>            
                        <td>{{ i.series }}</td>
                        <td>{{ i.repeticiones }}</td>
                        <td>{{ i.peso }}</td>
                        <td>                                
                            <a 
                            data-bs-toggle="tooltip" data-bs-placement="bottom" title="Editar" 
                            name="editsesion" 
                            id="editsesion" 
                            class="btn btn-info m-1 p-2" 
                            href="/editar_ejercicio/{{i.id}}" 
                            role="button">
                                <i class="fa-solid fa-pen-to-square"></i>
                            </a>
                            {% for j in ejercicios %}
                                {% if j.id == i.fk_id_ejercicio %}
                                    <a 
                                    data-bs-toggle="tooltip" data-bs-placement="bottom" title="Eliminar" 
                                    name="deletesesion" 
                                    id="deletesesion" 
                                    class="btn btn-danger m-1 p-2" 
                                    href="/eliminar_ejercicio_rutina/{{i.id}}/{{id_rutina}}/{{id_paciente}}"
                                    role="button">
                                        <i class="fa-solid fa-trash-can"></i>
                                    </a>
                                {% endif %}                                        
                            {% endfor %}
                            
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>                        
    </div>
</div>


<script>
    document.getElementById("borrarCampos").addEventListener("click", function () {
        document.getElementById("ejercicio").value = "";
        document.getElementById("series").value = "0";
        document.getElementById("repeticiones").value = "0";
    });
</script>

<script>
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
</script>
{% endblock %}
<!--    
    <div class="modal fade" id="modalAddEx" tabindex="-1" aria-labelledby="exampleModalLabe2l" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel2">A침adir ejercicio</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="container col-md-12 card" style="background-color:#c5d7f2">
                    <h3 style="border-radius: 15px; background-color: #3452b3; color: #d8d8ce;" class="p-2 mt-2 display-6 fw-bold card-title bg-gradient">Elija el ejercicio:</h3>
                    <form class="card-body" method="post">
                        <input type="hidden" name="">
                        <div class="form-floating mb-3">
                            <input
                                type="text"
                                class="form-control"
                                name="nombreEjercicio"
                                id="nombreEjercicio"
                                placeholder=""
                            />
                            <label for="nombreEjercicio">Ejercicio</label>
                        </div>
                        <div class="form-floating mb-3">
                            <input
                                type="number"
                                class="form-control"
                                name="peso"
                                id="peso"
                                placeholder=""
                            />
                            <label for="peso">Peso</label>
                        </div>
                        <div class="form-floating mb-3">
                            <input
                                type="number"
                                class="form-control"
                                name="repeticiones"
                                id="repeticiones"
                                placeholder=""
                            />
                            <label for="repeticiones">Repeticiones</label>
                        </div>
                                                
                    </form>
                </div>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-warning" data-bs-dismiss="modal"><i class="fa-solid fa-x"></i> Cerrar</button>
            </div>
        </div>
        </div>
    </div>
-->